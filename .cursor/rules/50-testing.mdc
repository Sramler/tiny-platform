---
description: æµ‹è¯•è§„èŒƒï¼ˆæµ‹è¯•æ–‡ä»¶è§¦å‘ï¼‰
globs:
  - "**/*Test.java"
  - "**/*Tests.java"
  - "**/*.spec.ts"
  - "**/*.test.ts"
  - "**/*.spec.tsx"
  - "**/*.test.tsx"
---

# 50 æµ‹è¯•è§„èŒƒ

## é€‚ç”¨èŒƒå›´

- é€‚ç”¨äºï¼š`**/*Test.java`ã€`**/*Tests.java`ã€`**/*.spec.ts`ã€`**/*.test.ts`ã€æµ‹è¯•ç›¸å…³æ–‡ä»¶

## ç¦æ­¢ï¼ˆMust Notï¼‰

- âŒ åªæœ‰"è·‘é€š"æ²¡æœ‰æ–­è¨€çš„æµ‹è¯•ã€‚
- âŒ æµ‹è¯•ä¾èµ–å¤–éƒ¨æœåŠ¡ï¼ˆæ•°æ®åº“ã€ç½‘ç»œã€æ–‡ä»¶ç³»ç»Ÿï¼‰è€Œä¸ä½¿ç”¨ mockã€‚
- âŒ æµ‹è¯•ç”¨ä¾‹ä¹‹é—´ç›¸äº’ä¾èµ–ï¼ˆæµ‹è¯•æ‰§è¡Œé¡ºåºå½±å“ç»“æœï¼‰ã€‚

## å¿…é¡»ï¼ˆMustï¼‰

- âœ… ä¿®å¤ bug / æ–°å¢é€»è¾‘å¿…é¡»æä¾›ï¼šæµ‹è¯•æˆ–æ˜ç¡®éªŒè¯æ­¥éª¤ã€‚
- âœ… æµ‹è¯•å‘½åæ¸…æ™°ï¼Œèƒ½è¡¨è¾¾åœºæ™¯ä¸é¢„æœŸï¼ˆæ ¼å¼ï¼š`æ–¹æ³•å_åœºæ™¯_é¢„æœŸç»“æœ`ï¼‰ã€‚
- âœ… æµ‹è¯•æ–­è¨€ï¼šä½¿ç”¨ `Assertions` æˆ– `assertThat`ï¼Œæ˜ç¡®æ–­è¨€é¢„æœŸç»“æœã€‚
- âœ… æµ‹è¯•éš”ç¦»ï¼šæ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ç‹¬ç«‹ï¼Œä¸ä¾èµ–å…¶ä»–æµ‹è¯•çš„æ‰§è¡Œç»“æœã€‚

## åº”è¯¥ï¼ˆShouldï¼‰

- âš ï¸ å¤–éƒ¨ä¾èµ–ç”¨ mockï¼šæ•°æ®åº“ä½¿ç”¨ `@MockBean` æˆ–å†…å­˜æ•°æ®åº“ï¼ˆH2ï¼‰ï¼Œå¤–éƒ¨æœåŠ¡ä½¿ç”¨ Mockitoã€‚
- âš ï¸ å…³é”®åˆ†æ”¯ä¸å¼‚å¸¸è·¯å¾„è¦è¦†ç›–ï¼šæ­£å¸¸æµç¨‹ã€è¾¹ç•Œæ¡ä»¶ã€å¼‚å¸¸æƒ…å†µéƒ½è¦æœ‰æµ‹è¯•ç”¨ä¾‹ã€‚
- âš ï¸ æµ‹è¯•æ•°æ®å‡†å¤‡ï¼šä½¿ç”¨ `@Sql` æˆ– `@TestData` å‡†å¤‡æµ‹è¯•æ•°æ®ï¼Œæµ‹è¯•åæ¸…ç†ã€‚
- âš ï¸ é›†æˆæµ‹è¯•ï¼šå…³é”®ä¸šåŠ¡æµç¨‹ä½¿ç”¨ `@SpringBootTest` ç¼–å†™é›†æˆæµ‹è¯•ã€‚
- âš ï¸ æµ‹è¯•è¦†ç›–ç‡ï¼šå…³é”®ä¸šåŠ¡é€»è¾‘ï¼ˆServiceã€Controllerï¼‰è¦†ç›–ç‡ â‰¥ 80%ã€‚

## å¯ä»¥ï¼ˆMayï¼‰

- ğŸ’¡ æ€§èƒ½æµ‹è¯•ï¼šå…³é”®æ¥å£ç¼–å†™æ€§èƒ½æµ‹è¯•ï¼ˆå“åº”æ—¶é—´ã€å¹¶å‘èƒ½åŠ›ï¼‰ã€‚
- ğŸ’¡ å¥‘çº¦æµ‹è¯•ï¼šAPI æ¥å£ä½¿ç”¨å¥‘çº¦æµ‹è¯•ï¼ˆå¦‚ Pactï¼‰ç¡®ä¿æ¥å£å…¼å®¹æ€§ã€‚

## ä¾‹å¤–ä¸è£å†³

- é›†æˆæµ‹è¯•ï¼šé›†æˆæµ‹è¯•å¯ä¾èµ–çœŸå®æ•°æ®åº“ï¼Œä½†å¿…é¡»ä½¿ç”¨ç‹¬ç«‹çš„æµ‹è¯•æ•°æ®åº“ã€‚
- æ€§èƒ½æµ‹è¯•ï¼šæ€§èƒ½æµ‹è¯•å¯ä¾èµ–å¤–éƒ¨æœåŠ¡ï¼Œä½†å¿…é¡»æ˜ç¡®æ ‡æ³¨ä¸”ä¸å½±å“ CI æµç¨‹ã€‚
- å†²çªæ—¶ï¼šå¹³å°ç‰¹å®šè§„åˆ™ï¼ˆ90+ï¼‰ä¼˜å…ˆäºæœ¬è§„èŒƒã€‚

## ç¤ºä¾‹

### âœ… æ­£ä¾‹

```java
@SpringBootTest
class UserServiceTest {
    @MockBean
    private UserRepository userRepository;
    
    @Test
    void getUserById_whenUserExists_returnsUser() {
        // Given
        Long userId = 1L;
        User user = new User(userId, "test");
        when(userRepository.findById(userId)).thenReturn(Optional.of(user));
        
        // When
        User result = userService.getUserById(userId);
        
        // Then
        assertThat(result).isNotNull();
        assertThat(result.getId()).isEqualTo(userId);
        assertThat(result.getUsername()).isEqualTo("test");
    }
    
    @Test
    void getUserById_whenUserNotExists_throwsException() {
        // Given
        Long userId = 999L;
        when(userRepository.findById(userId)).thenReturn(Optional.empty());
        
        // When & Then
        assertThatThrownBy(() -> userService.getUserById(userId))
            .isInstanceOf(UserNotFoundException.class);
    }
}
```

### âŒ åä¾‹

```java
// é”™è¯¯ï¼šæ²¡æœ‰æ–­è¨€ã€ä¾èµ–å¤–éƒ¨æœåŠ¡ã€æµ‹è¯•ä¹‹é—´ç›¸äº’ä¾èµ–
@Test
void testGetUser() {
    User user = userService.getUserById(1L); // âŒ æ²¡æœ‰æ–­è¨€
    // âŒ ä¾èµ–çœŸå®æ•°æ®åº“ï¼Œå¯èƒ½å› ä¸ºæ•°æ®ä¸å­˜åœ¨è€Œå¤±è´¥
}

@Test
void testUpdateUser() {
    // âŒ ä¾èµ–ä¸Šä¸€ä¸ªæµ‹è¯•åˆ›å»ºçš„æ•°æ®
    userService.updateUser(existingUser);
}
```

